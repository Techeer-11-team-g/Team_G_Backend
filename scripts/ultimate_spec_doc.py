#!/usr/bin/env python3
"""
AI 패션 어시스턴트 - 최종 완전판 (모든 경우의 수)
"""

from docx import Document
from docx.shared import Pt
from docx.enum.text import WD_ALIGN_PARAGRAPH
import os

def add_table(doc, title, data, headers, level=3):
    doc.add_heading(title, level=level)
    table = doc.add_table(rows=len(data)+1, cols=len(headers))
    table.style = 'Table Grid'
    for i, h in enumerate(headers):
        table.rows[0].cells[i].text = h
    for i, row in enumerate(data, 1):
        for j, val in enumerate(row):
            table.rows[i].cells[j].text = str(val)
    doc.add_paragraph()

def create_ultimate_document():
    doc = Document()
    style = doc.styles['Normal']
    style.font.name = 'Malgun Gothic'
    style.font.size = Pt(8)

    title = doc.add_heading('AI 패션 어시스턴트 에이전트 시스템', level=0)
    title.alignment = WD_ALIGN_PARAGRAPH.CENTER
    doc.add_paragraph('최종 완전 명세서 - 모든 사용자 입력 시나리오 (500+ Edge Cases)')
    doc.add_paragraph('작성일: 2026-01-20 | 버전: 5.0 Ultimate | Team_G Backend')
    doc.add_page_break()

    # ================================================================
    # SECTION 1: 입력 유형별 시나리오
    # ================================================================
    doc.add_heading('SECTION 1: 입력 유형별 시나리오', level=1)

    # 1.1 텍스트 입력
    doc.add_heading('1.1 텍스트 검색 - 기본', level=2)

    add_table(doc, '카테고리 (20종)', [
        ('상의', '티셔츠/셔츠/블라우스/니트/맨투맨/후드티/조끼', 'top'),
        ('하의', '바지/청바지/슬랙스/반바지/치마/레깅스', 'bottom'),
        ('아우터', '자켓/코트/패딩/가디건/점퍼/집업/베스트', 'outer'),
        ('원피스', '원피스/드레스/점프수트', 'dress'),
        ('신발', '운동화/구두/부츠/샌들/슬리퍼/로퍼', 'shoes'),
        ('가방', '백팩/토트/크로스/숄더/클러치/에코백', 'bag'),
        ('악세서리', '모자/벨트/시계/목걸이/귀걸이/반지/선글라스', 'accessory'),
        ('언더웨어', '속옷/양말/스타킹', 'underwear'),
        ('수영복', '비키니/래쉬가드/원피스수영복', 'swimwear'),
        ('운동복', '레깅스/요가복/트레이닝/스포츠브라', 'activewear'),
        ('정장', '수트/블레이저/정장바지', 'suit'),
        ('한복', '한복/생활한복', 'hanbok'),
        ('파자마', '잠옷/홈웨어/라운지웨어', 'sleepwear'),
        ('유니폼', '교복/작업복/유니폼', 'uniform'),
        ('빈티지', '빈티지/중고/레트로', 'vintage'),
        ('키즈', '아동복/유아복', 'kids'),
        ('커플', '커플룩/시밀러룩', 'couple'),
        ('세트', '세트/코디세트', 'set'),
        ('복수', '"상의랑 바지", "전체"', 'multiple'),
        ('모호', '"뭐 없어?", "입을 거"', 'ambiguous'),
    ], ['카테고리', '하위 항목', '코드'])

    add_table(doc, '색상 (25종)', [
        ('기본', '검정/흰색/빨강/파랑/노랑/초록/주황/보라/분홍', '기본색'),
        ('세부', '네이비/버건디/카키/베이지/아이보리/크림/그레이', '세부색'),
        ('메탈릭', '골드/실버/로즈골드/브론즈', '메탈릭'),
        ('톤', '밝은/진한/연한/어두운/파스텔/비비드', '톤조합'),
        ('계절', '봄컬러/가을컬러/여름컬러/겨울컬러', '계절'),
        ('복합', '투톤/그라데이션/멀티컬러', '복합'),
        ('패턴색', '블랙앤화이트/레드앤블루', '패턴'),
        ('비유', '하늘색/살구색/와인색/머스타드', '비유'),
        ('브랜드', '샤넬블랙/티파니블루/에르메스오렌지', '브랜드'),
        ('제외', '"검정 말고", "흰색 빼고"', '제외'),
        ('범위', '"블루계열", "웜톤"', '범위'),
    ], ['유형', '예시', '처리'])

    add_table(doc, '브랜드 (15종)', [
        ('정확', '나이키/아디다스/자라/유니클로/H&M', '정확매칭'),
        ('약어', '나키/아디/유니클', '약어해석'),
        ('오타', '나이게/아디디스', '오타교정'),
        ('영문', 'Nike/Adidas/ZARA', '영문매칭'),
        ('한영혼용', '나이키Nike', '통합'),
        ('서브브랜드', '나이키조던/아디다스오리지널스', '서브'),
        ('콜라보', '나이키x오프화이트/H&Mx디자이너', '콜라보'),
        ('그룹', '스포츠브랜드/SPA/명품/디자이너', '그룹'),
        ('국가', '한국브랜드/일본브랜드/유럽', '국가'),
        ('가격대', '저가/중가/고가/명품', '가격대'),
        ('복수', '"나이키나 아디다스"', '복수'),
        ('제외', '"나이키 말고"', '제외'),
        ('신생', '신생브랜드/인디브랜드', '신생'),
        ('단종', '단종브랜드', '단종'),
        ('모호', '"그 브랜드", "유명한 거"', '모호'),
    ], ['유형', '예시', '처리'])

    add_table(doc, '스타일/분위기 (30종)', [
        ('기본', '캐주얼/포멀/스포티/빈티지/미니멀', '기본'),
        ('트렌드', 'Y2K/고프코어/블록코어/올드머니/쿼터코어', '트렌드'),
        ('감성', '힙한/시크한/큐트한/모던한/클래식한', '감성'),
        ('계절', '여름/겨울/봄/가을/환절기', '계절'),
        ('TPO', '출근/데이트/면접/결혼식/장례식/여행', 'TPO'),
        ('활동', '등산/러닝/헬스/요가/수영/골프/테니스', '활동'),
        ('나이', '10대/20대/30대/40대/50대이상', '나이'),
        ('성별', '남자/여자/유니섹스', '성별'),
        ('체형', '마른/보통/통통/키큰/키작은', '체형'),
        ('복합', '"캐주얼하면서 세련된", "편하지만 고급"', '복합'),
        ('부정', '"촌스럽지 않은", "화려하지 않은"', '부정'),
        ('비유', '"연예인스타일", "인스타감성", "파리지앵"', '비유'),
        ('문화', '한국/일본/미국/유럽/스트릿', '문화'),
        ('서브컬처', '힙합/펑크/고스/프레피/아이비', '서브컬처'),
        ('직업', '오피스/크리에이티브/프리랜서', '직업'),
    ], ['유형', '예시', '처리'])

    add_table(doc, '상세 속성 (25종)', [
        ('핏', '슬림/레귤러/오버/루즈/타이트/박시', 'fit'),
        ('기장-상의', '크롭/레귤러/롱/미디', 'top_length'),
        ('기장-하의', '숏/미디/롱/7부/9부', 'bottom_length'),
        ('기장-아우터', '숏/미디/롱/니렝스', 'outer_length'),
        ('소매', '긴팔/반팔/민소매/7부/캡소매', 'sleeve'),
        ('넥라인', '라운드/브이넥/터틀/오프숄더/홀터/스퀘어', 'neckline'),
        ('칼라', '셔츠칼라/차이나/노칼라/후드', 'collar'),
        ('소재', '면/린넨/울/캐시미어/데님/가죽/실크/폴리', 'material'),
        ('패턴', '무지/스트라이프/체크/플로럴/도트/카모/애니멀', 'pattern'),
        ('디테일', '지퍼/단추/후드/포켓/프릴/레이스/자수', 'detail'),
        ('두께', '얇은/중간/두꺼운/기모/누빔/패딩', 'thickness'),
        ('안감', '있음/없음/탈부착', 'lining'),
        ('신축성', '있음/없음/약간', 'stretch'),
        ('투명도', '비침/안비침/시스루', 'transparency'),
        ('마감', '오버로크/바이어스/원단끝', 'finish'),
        ('세탁', '물세탁/드라이/손세탁', 'washing'),
        ('관리', '다림질필요/노아이론/주름방지', 'care'),
        ('계절성', '여름용/겨울용/사계절', 'seasonality'),
        ('기능', '방수/방풍/자외선차단/속건', 'function'),
        ('친환경', '오가닉/리사이클/비건', 'eco'),
    ], ['속성', '값', '코드'])

    add_table(doc, '가격 조건 (15종)', [
        ('상한', '"5만원 이하", "10만원 미만", "100불 이하"', 'max'),
        ('하한', '"3만원 이상", "5만원 넘는"', 'min'),
        ('범위', '"3~5만원", "5-10만원 사이"', 'range'),
        ('정확', '"딱 5만원", "정확히 10만원"', 'exact'),
        ('상대', '"저렴한", "비싼", "적당한", "합리적인"', 'relative'),
        ('예산', '"예산 10만원", "총 20만원 내로"', 'budget'),
        ('할인', '"할인하는", "세일 중인", "50% 이상"', 'discount'),
        ('가성비', '"가성비 좋은", "가격대비"', 'value'),
        ('프리미엄', '"명품", "고급", "프리미엄"', 'premium'),
        ('정렬', '"가격순", "싼순", "비싼순"', 'sort'),
        ('비교', '"이것보다 싼", "저것보다 비싼"', 'compare'),
        ('단위', '"만원", "천원", "달러", "엔"', 'unit'),
        ('모호', '"좀 싼", "너무 비싸지 않게"', 'vague'),
        ('무료', '"무료배송", "배송비 포함"', 'free'),
        ('추가비용', '"관세 포함", "세금 별도"', 'additional'),
    ], ['유형', '예시', '처리'])

    # 1.2 이미지 입력
    doc.add_heading('1.2 이미지 입력', level=2)

    add_table(doc, '이미지 유형 (30종)', [
        ('전신착장', '전신+옷', '전체분석'),
        ('반신', '상반신/하반신', '부분분석'),
        ('뒷모습', '후면', '후면분석'),
        ('측면', '옆면', '측면분석'),
        ('거울셀카', '반전됨', '좌우반전'),
        ('그룹사진', '여러사람', '선택요청'),
        ('크롭사진', '일부만', '부분분석'),
        ('상품단독', '옷만', '직접분석'),
        ('평면배치', 'Flat lay', '각각분석'),
        ('옷걸이', '걸린상태', '상품분석'),
        ('마네킹', '마네킹착용', '상품분석'),
        ('접힌상태', '개어진옷', '분석시도'),
        ('포장', '포장상태', '어려움'),
        ('디테일', '클로즈업', '부분기반'),
        ('잡지', '편집사진', '스타일분석'),
        ('SNS', '인스타/핀터', '스타일분석'),
        ('연예인', '유명인', '유사검색'),
        ('스크린샷', '쇼핑몰캡처', '상품추출'),
        ('일러스트', '그림', '스타일해석'),
        ('AI생성', 'AI이미지', '한계안내'),
        ('콜라주', '합성', '영역식별'),
        ('동영상캡처', '영상에서', '분석시도'),
        ('움직임', '모션블러', '어려움'),
        ('리뷰사진', '구매후기', '상품식별'),
        ('착용샷', '실착사진', '상품분석'),
        ('비교사진', '전후비교', '비교분석'),
        ('코디사진', '여러벌', '각각분석'),
        ('룩북', '브랜드룩북', '스타일분석'),
        ('런웨이', '패션쇼', '트렌드분석'),
        ('거리패션', '스트릿스냅', '스타일분석'),
    ], ['유형', '설명', '처리'])

    add_table(doc, '이미지 품질 (20종)', [
        ('저해상도', '<100px', '재업로드'),
        ('고해상도', '>10MB', '리사이즈'),
        ('흐릿함', '초점불량', '재요청'),
        ('어두움', '조명부족', '보정시도'),
        ('과노출', '너무밝음', '한계안내'),
        ('노이즈', '화질저하', '분석시도'),
        ('압축', 'JPEG아티팩트', '분석시도'),
        ('필터', '색상왜곡', '원본추정'),
        ('흑백', '컬러없음', '색상제외'),
        ('세피아', '세피아톤', '색상제외'),
        ('손상', '읽기불가', '재업로드'),
        ('미지원', 'GIF/BMP/TIFF/HEIC', '형식안내'),
        ('회전', '90/180/270도', '자동보정'),
        ('비율문제', '극단적비율', '분석시도'),
        ('워터마크', '로고삽입', '제외분석'),
        ('텍스트', '글자포함', '제외분석'),
        ('모자이크', '일부가림', '분석불가'),
        ('부분잘림', '프레임밖', '보이는부분'),
        ('중복', '같은이미지', '캐시활용'),
        ('애니메이션', 'GIF', '첫프레임'),
    ], ['문제', '설명', '처리'])

    add_table(doc, '이미지 내용 (15종)', [
        ('패션없음', '풍경/음식/동물', '안내'),
        ('부적절', 'NSFW', '거부'),
        ('가려짐', '물체에가림', '보이는부분'),
        ('겹침', '옷겹침', '주요아이템'),
        ('복잡배경', '산만', '객체분리'),
        ('다중인물', '여러사람', '선택요청'),
        ('동물착용', '반려동물', '분석시도'),
        ('인형', '피규어/마네킹', '분석시도'),
        ('저작권', '브랜드로고명확', '일반분석'),
        ('폭력적', '부적절내용', '거부'),
        ('광고', '광고이미지', '분석시도'),
        ('합성의심', '조작이미지', '분석시도'),
        ('아이콘', '로고/심볼', '안내'),
        ('텍스트만', '글자이미지', '안내'),
        ('QR코드', 'QR/바코드', '안내'),
    ], ['문제', '설명', '처리'])

    # 1.3 복합 입력
    doc.add_heading('1.3 복합 입력 (이미지+텍스트)', level=2)

    add_table(doc, '복합 입력 유형 (20종)', [
        ('유사검색', '이미지+"비슷한거"', '이미지기반'),
        ('크로스', '이미지+"어울리는바지"', '크로스카테고리'),
        ('스타일적용', '이미지+"이스타일로"', '스타일적용'),
        ('색상변경', '이미지+"검정으로"', '색상변형'),
        ('브랜드변경', '이미지+"나이키로"', '브랜드변형'),
        ('가격변경', '이미지+"더싸게"', '가격조건'),
        ('분석', '이미지+"분석해줘"', '속성추출'),
        ('피팅', '이미지+"입어볼래"', '피팅요청'),
        ('구매', '이미지+"살래"', '구매프로세스'),
        ('비교', '2이미지+"뭐가나아?"', '비교'),
        ('조합', '2이미지+"어울려?"', '매칭'),
        ('부분', '이미지+"상의만"', '부분추출'),
        ('제외', '이미지+"이거말고"', '제외검색'),
        ('추가', '이미지+"여기에더"', '추가검색'),
        ('수정', '이미지+"조금다르게"', '변형검색'),
        ('확인', '이미지+"이거맞아?"', '확인'),
        ('정보', '이미지+"얼마야?"', '정보조회'),
        ('재고', '이미지+"있어?"', '재고확인'),
        ('사이즈', '이미지+"사이즈?"', '사이즈추천'),
        ('리뷰', '이미지+"후기?"', '리뷰조회'),
    ], ['시나리오', '입력', '처리'])

    add_table(doc, '상충/모순 입력 (10종)', [
        ('색상불일치', '빨간옷+"파란옷"', '확인질문'),
        ('카테고리불일치', '바지+"셔츠"', '확인질문'),
        ('스타일불일치', '캐주얼+"정장"', '확인질문'),
        ('수량불일치', '1개+"3개"', '확인질문'),
        ('모호지시', '여러개+"이거"', '선택요청'),
        ('무관이미지', '풍경+"바지찾아"', '무관안내'),
        ('반대요청', '이미지+"이거말고"', '제외검색'),
        ('시간불일치', '"아까거"(없음)', '안내'),
        ('브랜드불일치', '나이키옷+"아디다스"', '확인질문'),
        ('성별불일치', '여성복+"남자옷"', '확인질문'),
    ], ['상충', '예시', '처리'])

    add_table(doc, '입력 순서 변형 (8종)', [
        ('이미지먼저', '이미지→텍스트', '이미지컨텍스트'),
        ('텍스트먼저', '텍스트→이미지', '텍스트컨텍스트'),
        ('동시', '이미지+텍스트동시', '통합분석'),
        ('순차이미지', '이미지1→이미지2', '순차분석'),
        ('수정중추가', '텍스트입력중이미지', '통합'),
        ('이미지교체', '이미지1→이미지2(교체)', '새분석'),
        ('텍스트추가', '이미지→텍스트추가', '조건추가'),
        ('혼합순서', '텍스트→이미지→텍스트', '통합'),
    ], ['순서', '설명', '처리'])

    doc.add_page_break()

    # ================================================================
    # SECTION 2: 대화/컨텍스트 시나리오
    # ================================================================
    doc.add_heading('SECTION 2: 대화 및 컨텍스트 시나리오', level=1)

    doc.add_heading('2.1 참조 표현', level=2)

    add_table(doc, '직접 참조 (15종)', [
        ('"그거"', '직전항목', 'last_item'),
        ('"이거"', '현재표시', 'current'),
        ('"저거"', '이전결과', 'prev_result'),
        ('"그것들"', '복수항목', 'items'),
        ('"첫번째"', '첫번째', 'index_0'),
        ('"두번째"', '두번째', 'index_1'),
        ('"마지막"', '마지막', 'index_-1'),
        ('"중간거"', '중간', 'index_mid'),
        ('"맨위"', '상단', 'index_0'),
        ('"맨아래"', '하단', 'index_-1'),
        ('"1번"', '번호', 'index_n'),
        ('"빨간거"', '속성참조', 'by_attr'),
        ('"싼거"', '조건참조', 'by_condition'),
        ('"나이키거"', '브랜드참조', 'by_brand'),
        ('"아까그스타일"', '스타일참조', 'by_style'),
    ], ['표현', '의미', '처리'])

    add_table(doc, '시간 참조 (10종)', [
        ('"아까"', '세션내이전', 'session_prev'),
        ('"방금"', '직전', 'just_now'),
        ('"처음에"', '세션시작', 'session_start'),
        ('"어제"', '이전세션', 'prev_session'),
        ('"지난번"', '이전방문', 'prev_visit'),
        ('"최근"', '최근n개', 'recent'),
        ('"전에"', '이전시점', 'before'),
        ('"나중에본거"', '이후항목', 'later'),
        ('"중간에"', '중간시점', 'mid_session'),
        ('"계속보던거"', '반복조회', 'frequently'),
    ], ['표현', '의미', '처리'])

    add_table(doc, '세션/상태 참조 (12종)', [
        ('"검색한거"', 'search_results', '검색결과'),
        ('"피팅한거"', 'fitting_results', '피팅결과'),
        ('"담은거"', 'cart_items', '장바구니'),
        ('"찜한거"', 'wishlist', '위시리스트'),
        ('"산거"', 'orders', '주문이력'),
        ('"본거"', 'viewed', '조회이력'),
        ('"비교한거"', 'compared', '비교이력'),
        ('"저장한거"', 'saved', '저장항목'),
        ('"좋아한거"', 'liked', '좋아요'),
        ('"숨긴거"', 'hidden', '숨김항목'),
        ('"삭제한거"', 'deleted', '삭제복구'),
        ('"추천받은거"', 'recommended', '추천이력'),
    ], ['표현', '대상', '변수'])

    add_table(doc, '복잡한 참조 체인 (8종)', [
        ('"아까그거에서색만바꾼거"', '참조+수정', '체인참조'),
        ('"처음본거랑비슷한데더싼"', '참조+조건', '체인참조'),
        ('"그중에서2번"', '참조+인덱싱', '체인참조'),
        ('"아까피팅한것중검정"', '참조+필터', '체인참조'),
        ('"저번에산거랑같은브랜드"', '이력참조', '체인참조'),
        ('"그스타일에서바지만"', '참조+추출', '체인참조'),
        ('"첫번째거색상으로두번째거"', '교차참조', '체인참조'),
        ('"아까본거다시근데L로"', '참조+변경', '체인참조'),
    ], ['표현', '유형', '처리'])

    doc.add_heading('2.2 멀티턴 대화', level=2)

    add_table(doc, '대화 패턴 (15종)', [
        ('필터누적', '"바지"→"검정"→"슬림"', '조건누적'),
        ('조건교체', '"검정"→"아니네이비"', '조건교체'),
        ('주제전환', '"바지"→"신발도"', '새검색추가'),
        ('되돌아가기', '"아까바지로"', '상태복원'),
        ('선택연속', '"1번"→"그거피팅"', '선택유지'),
        ('부정누적', '"이거말고"→"저것도"', '제외누적'),
        ('좁히기', '"이중에서"→"무지만"', '결과필터'),
        ('넓히기', '"비슷한것도"', '조건완화'),
        ('수정', '"아니그게아니라"', '이전취소'),
        ('확인', '"이게맞아?"', '확정요청'),
        ('반복', '"다시보여줘"', '재표시'),
        ('비교전환', '"이거랑저거"', '비교모드'),
        ('피팅전환', '"입어볼래"', '피팅모드'),
        ('구매전환', '"살래"', '구매모드'),
        ('종료', '"됐어", "끝"', '대화종료'),
    ], ['패턴', '예시', '처리'])

    add_table(doc, '문맥 전환 (10종)', [
        ('완전변경', '"바지"→"신발로바꿔"', '새검색'),
        ('카테고리추가', '"바지"→"상의도"', '병렬검색'),
        ('비교전환', '"이거랑저거"', '비교모드'),
        ('피팅전환', '"입어볼래"', '피팅모드'),
        ('구매전환', '"살래"', '구매모드'),
        ('이전복귀', '"아까그거로"', '상태복원'),
        ('처음부터', '"다시처음부터"', '리셋'),
        ('다른주제', '"근데사이즈는"', '주제추가'),
        ('질문전환', '"이거얼마야?"', '정보요청'),
        ('피드백', '"별로야"', '대안요청'),
    ], ['전환', '예시', '처리'])

    add_table(doc, '조건부 요청 (10종)', [
        ('있으면', '"있으면담아줘"', '조건확인후실행'),
        ('없으면', '"없으면비슷한거"', '폴백'),
        ('괜찮으면', '"괜찮으면주문"', '확인요청'),
        ('싸면', '"싸면살게"', '가격조건'),
        ('재고', '"재고있으면"', '재고확인'),
        ('배송', '"오늘되면"', '배송조건'),
        ('사이즈', '"L있으면"', '사이즈확인'),
        ('할인', '"할인하면"', '할인조건'),
        ('조합', '"둘다되면"', '복합조건'),
        ('아니면', '"아니면다른거"', '대안'),
    ], ['조건', '예시', '처리'])

    doc.add_page_break()

    # ================================================================
    # SECTION 3: 기능별 상세 시나리오
    # ================================================================
    doc.add_heading('SECTION 3: 기능별 상세 시나리오', level=1)

    doc.add_heading('3.1 검색/필터', level=2)

    add_table(doc, '검색 수정 (12종)', [
        ('결과좁히기', '"이중에서무지만"', '필터추가'),
        ('결과넓히기', '"비슷한것도"', '조건완화'),
        ('재검색', '"다시찾아줘"', '동일재검색'),
        ('조건추가', '"여기에면소재로"', '필터추가'),
        ('조건제거', '"색상빼고"', '필터제거'),
        ('조건교체', '"검정말고네이비"', '필터교체'),
        ('정렬변경', '"싼순으로"', '정렬변경'),
        ('개수변경', '"더많이"', 'limit증가'),
        ('페이지', '"다음", "더보기"', '페이지네이션'),
        ('이전결과', '"아까결과로"', '상태복원'),
        ('초기화', '"조건다빼고"', '필터리셋'),
        ('저장', '"이조건저장"', '필터저장'),
    ], ['동작', '예시', '처리'])

    add_table(doc, '정렬/필터 조합 (10종)', [
        ('가격+인기', '"싼것중인기순"', '복합정렬'),
        ('색상+브랜드', '"검정나이키"', '복합필터'),
        ('스타일+가격', '"캐주얼5만원이하"', '복합'),
        ('사이즈+재고', '"L재고있는"', '복합'),
        ('신상+할인', '"신상할인"', '복합'),
        ('리뷰+가격', '"후기좋고싼"', '복합'),
        ('배송+가격', '"무배싼순"', '복합'),
        ('브랜드+스타일', '"나이키캐주얼"', '복합'),
        ('소재+계절', '"린넨여름"', '복합'),
        ('전체', '"검정슬림면바지5만원이하"', '다중'),
    ], ['조합', '예시', '처리'])

    doc.add_heading('3.2 피팅', level=2)

    add_table(doc, '피팅 요청 (15종)', [
        ('단일', '"이거입어볼래"', 'single'),
        ('번호', '"1번피팅"', 'indexed'),
        ('전체', '"다입어볼래"', 'batch'),
        ('선택', '"1,3번만"', 'selected'),
        ('비교', '"둘다입어서비교"', 'compare'),
        ('조합', '"상의1+하의2"', 'outfit'),
        ('전체코디', '"전체코디"', 'full_outfit'),
        ('다른색', '"검정으로피팅"', 'color_var'),
        ('다른사이즈', '"L로피팅"', 'size_var'),
        ('재피팅', '"다시"', 'retry'),
        ('추가', '"이것도"', 'add'),
        ('제외', '"이거빼고"', 'exclude'),
        ('순서', '"바지먼저"', 'order'),
        ('스타일', '"캐주얼하게"', 'style'),
        ('포즈', '"다른포즈"', '미지원'),
    ], ['유형', '예시', '처리'])

    add_table(doc, '피팅 전제조건/상황 (12종)', [
        ('이미지없음', '전신미등록', '업로드안내'),
        ('상품없음', '검색안함', '검색유도'),
        ('카테고리불가', '액세서리', '미지원안내'),
        ('이미지부적합', '얼굴만', '전신요청'),
        ('진행중', '중복요청', '대기안내'),
        ('API한도', '일일한도', '한도안내'),
        ('API오류', '서버오류', '재시도'),
        ('타임아웃', '시간초과', '비동기'),
        ('부분실패', '일부실패', '성공분반환'),
        ('취소', '진행중취소', '중단'),
        ('결과대기', '"다됐어?"', '상태확인'),
        ('결과저장', '"저장해줘"', '저장'),
    ], ['상황', '설명', '처리'])

    doc.add_heading('3.3 커머스', level=2)

    add_table(doc, '사이즈 (18종)', [
        ('추천요청', '"사이즈뭐가좋아?"', '추천'),
        ('신체정보', '"175cm70kg"', '정보저장'),
        ('평소사이즈', '"보통L입어"', '히스토리'),
        ('브랜드별', '"이브랜드사이즈?"', '가이드'),
        ('비교', '"M이랑L차이"', '비교표'),
        ('재고', '"L있어?"', '재고확인'),
        ('핏선호', '"넉넉하게"', '사이즈업'),
        ('체형', '"어깨넓어"', '보정추천'),
        ('허리', '"32인치"', '측정기반'),
        ('발', '"260mm"', '신발사이즈'),
        ('해외', '"US9/EU42"', '변환'),
        ('애매', '"M/L사이"', '양쪽안내'),
        ('과거', '"전에M샀는데"', '이력참조'),
        ('실패', '"M작았어"', '사이즈업'),
        ('브랜드차이', '"여기는크게나와"', '보정'),
        ('추천근거', '"왜L?"', '설명'),
        ('다른의견', '"M이나을것같은데"', '비교'),
        ('확신없음', '"잘모르겠어"', '가이드'),
    ], ['상황', '예시', '처리'])

    add_table(doc, '장바구니 (15종)', [
        ('추가', '"담아줘"', 'add'),
        ('번호', '"1번담아"', 'add_idx'),
        ('복수', '"1,3번담아"', 'add_multi'),
        ('사이즈', '"L로담아"', 'add_size'),
        ('수량', '"2개담아"', 'add_qty'),
        ('전체옵션', '"검정L2개"', 'add_full'),
        ('보기', '"장바구니"', 'view'),
        ('삭제', '"빼줘"', 'remove'),
        ('전체삭제', '"비워줘"', 'clear'),
        ('수량변경', '"3개로"', 'update_qty'),
        ('사이즈변경', '"M으로"', 'update_size'),
        ('합계', '"총얼마?"', 'total'),
        ('중복', '이미있는상품', '수량확인'),
        ('품절', '재고없음', '대안'),
        ('가격변동', '담은후변동', '알림'),
    ], ['동작', '예시', '처리'])

    add_table(doc, '주문 (20종)', [
        ('주문', '"주문할게"', 'create'),
        ('즉시구매', '"바로살게"', 'direct'),
        ('일부주문', '"1번만주문"', 'partial'),
        ('확인', '"주문내역"', 'history'),
        ('상태', '"배송어디?"', 'tracking'),
        ('취소', '"취소해줘"', 'cancel'),
        ('부분취소', '"1번만취소"', 'partial_cancel'),
        ('교환', '"교환"', 'exchange'),
        ('반품', '"반품"', 'return'),
        ('환불', '"환불"', 'refund'),
        ('배송지', '"주소바꿀게"', 'address'),
        ('결제수단', '"카드로"', 'payment'),
        ('쿠폰', '"쿠폰?"', 'coupon'),
        ('포인트', '"포인트"', 'points'),
        ('영수증', '"영수증"', 'receipt'),
        ('선물', '"선물포장"', 'gift'),
        ('메모', '"배송메모"', 'memo'),
        ('예약', '"예약배송"', 'schedule'),
        ('분할', '"나눠서"', 'split'),
        ('합배송', '"같이배송"', 'combine'),
    ], ['동작', '예시', '처리'])

    add_table(doc, '결제 Edge Cases (12종)', [
        ('중단', '브라우저닫기', '미완료처리'),
        ('실패', '카드오류', '재시도'),
        ('이중', '중복클릭', '방지'),
        ('타임아웃', '시간초과', '재시도'),
        ('품절', '결제중품절', '안내+환불'),
        ('가격변동', '결제중변동', '최신가'),
        ('한도', '카드한도', '다른수단'),
        ('인증실패', '3DS실패', '재시도'),
        ('포인트부족', '포인트부족', '안내'),
        ('쿠폰만료', '쿠폰기한', '안내'),
        ('시스템점검', '점검중', '안내'),
        ('은행오류', '은행점검', '안내'),
    ], ['상황', '설명', '처리'])

    doc.add_page_break()

    # ================================================================
    # SECTION 4: 특수 상황 시나리오
    # ================================================================
    doc.add_heading('SECTION 4: 특수 상황 시나리오', level=1)

    doc.add_heading('4.1 타이밍/비동기', level=2)

    add_table(doc, '타이밍 이슈 (15종)', [
        ('빠른연속', '연타입력', '디바운싱'),
        ('응답전입력', '대기중추가', '큐잉'),
        ('피팅대기', '피팅중다른요청', '병렬'),
        ('세션만료직전', 'TTL임박', '연장'),
        ('장시간대기', '30분후재접속', '복원'),
        ('자정경과', '날짜변경', '세션유지'),
        ('동시요청', '같은시점2개', '순차'),
        ('새벽접속', '트래픽낮음', '정상'),
        ('피크타임', '트래픽높음', '대기열'),
        ('점검시간', '시스템점검', '안내'),
        ('배치작업', '백그라운드', '지연'),
        ('캐시만료', '캐시TTL', '새로고침'),
        ('토큰갱신', '인증만료', '자동갱신'),
        ('롱폴링', '긴대기', '타임아웃'),
        ('웹소켓끊김', '연결끊김', '재연결'),
    ], ['상황', '설명', '처리'])

    add_table(doc, '비동기 작업 (10종)', [
        ('피팅완료전취소', '진행중취소', '중단'),
        ('결과지연', 'API느림', '진행표시'),
        ('부분실패', '일부성공', '성공분반환'),
        ('타임아웃', '시간초과', '재시도'),
        ('결과확인', '"다됐어?"', '상태조회'),
        ('알림수신', '완료알림', '결과표시'),
        ('백그라운드', '앱전환', '계속진행'),
        ('푸시알림', '완료푸시', '앱복귀'),
        ('이메일알림', '완료이메일', '링크'),
        ('진행상황', '"얼마나남았어?"', '진행률'),
    ], ['상황', '설명', '처리'])

    doc.add_heading('4.2 동시성/경쟁', level=2)

    add_table(doc, '동시성 문제 (10종)', [
        ('재고1개', '동시주문', '선착순'),
        ('동시장바구니', '여러기기', '동기화'),
        ('세션충돌', '다중탭', '최신우선'),
        ('가격변동', '조회vs주문', '최신가'),
        ('상품삭제', '보기vs삭제', '안내'),
        ('동시피팅', '같은상품', '큐잉'),
        ('동시결제', '중복결제', '방지'),
        ('동시수정', '프로필수정', '충돌처리'),
        ('동시리뷰', '같은상품', '허용'),
        ('락경쟁', '동시접근', '대기'),
    ], ['상황', '설명', '처리'])

    doc.add_heading('4.3 환경/디바이스', level=2)

    add_table(doc, '디바이스 (12종)', [
        ('모바일', '작은화면', '간결응답'),
        ('태블릿', '중간화면', '적응형'),
        ('데스크톱', '큰화면', '상세응답'),
        ('다중기기', '동시접속', '동기화'),
        ('기기전환', '모바일→PC', '이어하기'),
        ('저사양', '느린기기', '경량화'),
        ('고사양', '빠른기기', '풀기능'),
        ('터치', '터치입력', '터치UI'),
        ('마우스', '클릭입력', '클릭UI'),
        ('키보드', '단축키', '키보드UI'),
        ('음성', '음성입력', '음성UI'),
        ('접근성', '보조기기', '접근성'),
    ], ['환경', '설명', '처리'])

    add_table(doc, '네트워크 (10종)', [
        ('느린연결', '지연', '로딩'),
        ('불안정', '끊김', '재시도'),
        ('오프라인', '연결끊김', '오프라인'),
        ('재연결', '복구', '동기화'),
        ('타임아웃', '응답없음', '재시도'),
        ('3G/4G', '모바일네트워크', '최적화'),
        ('WiFi', '안정연결', '정상'),
        ('로밍', '해외', '안내'),
        ('VPN', 'VPN사용', '정상'),
        ('프록시', '프록시', '정상'),
    ], ['상황', '설명', '처리'])

    add_table(doc, '브라우저/앱 (12종)', [
        ('뒤로가기', '브라우저뒤로', '상태처리'),
        ('새로고침', 'F5', '세션유지'),
        ('탭전환', '다른탭', '백그라운드'),
        ('앱전환', '백그라운드', '상태유지'),
        ('앱종료', '강제종료', '자동저장'),
        ('푸시클릭', '알림클릭', '해당화면'),
        ('딥링크', 'URL직접', '컨텍스트'),
        ('북마크', '북마크접근', '정상'),
        ('공유링크', '공유URL', '컨텍스트'),
        ('QR코드', 'QR스캔', '해당화면'),
        ('앱설치', '앱유도', '스토어'),
        ('업데이트', '앱업데이트', '안내'),
    ], ['상황', '설명', '처리'])

    doc.add_heading('4.4 사용자 상태', level=2)

    add_table(doc, '사용자 유형 (15종)', [
        ('신규', '첫방문', '온보딩'),
        ('재방문', '이력있음', '개인화'),
        ('로그인', '인증됨', '프로필'),
        ('비로그인', '게스트', '기본'),
        ('VIP', '우수고객', '우선'),
        ('휴면', '오랜만', '환영'),
        ('탈퇴예정', '탈퇴중', '제한'),
        ('제재', '정지상태', '안내'),
        ('신규가입', '방금가입', '혜택'),
        ('등업직전', '등업임박', '안내'),
        ('포인트만료', '만료임박', '안내'),
        ('생일', '생일당일', '혜택'),
        ('기념일', '가입기념', '혜택'),
        ('초대가입', '추천가입', '혜택'),
        ('기업회원', 'B2B', '별도'),
    ], ['유형', '설명', '처리'])

    add_table(doc, '인증 상태 (10종)', [
        ('세션만료', '토큰만료', '재로그인'),
        ('동시로그인', '다른기기', '정책'),
        ('비밀번호변경', '강제로그아웃', '재로그인'),
        ('권한없음', '로그인필요', '유도'),
        ('권한부족', '기능제한', '업그레이드'),
        ('2FA필요', '추가인증', '인증요청'),
        ('본인확인', '본인인증', '인증요청'),
        ('성인인증', '성인확인', '인증요청'),
        ('이메일미인증', '이메일확인', '인증요청'),
        ('휴대폰미인증', '휴대폰확인', '인증요청'),
    ], ['상황', '설명', '처리'])

    doc.add_page_break()

    # ================================================================
    # SECTION 5: 입력 형식/패턴
    # ================================================================
    doc.add_heading('SECTION 5: 입력 형식 및 패턴', level=1)

    doc.add_heading('5.1 텍스트 형식', level=2)

    add_table(doc, '문장 형식 (15종)', [
        ('질문형', '"있어요?", "찾아줄래?"', '검색'),
        ('명령형', '"찾아", "보여줘"', '실행'),
        ('서술형', '"필요해", "찾고있어"', '의도파악'),
        ('단어만', '"바지"', '의도확인'),
        ('리스트', '"1.검정 2.슬림"', '조건파싱'),
        ('장문', '긴설명', '핵심추출'),
        ('반복', '"바지바지"', '정규화'),
        ('대문자', '"NIKE"', '정규화'),
        ('소문자', '"nike"', '정규화'),
        ('혼합', '"Nike바지"', '통합'),
        ('괄호', '"바지(검정)"', '파싱'),
        ('따옴표', '"\"검정바지\""', '파싱'),
        ('하이픈', '"슬림-핏"', '파싱'),
        ('슬래시', '"M/L"', '파싱'),
        ('앤드', '"검정&흰색"', '파싱'),
    ], ['형식', '예시', '처리'])

    add_table(doc, '특수 입력 (12종)', [
        ('이모지만', '"👖"', '해석'),
        ('특수문자', '"!!!", "???"', '정규화'),
        ('숫자만', '"12345"', '의도확인'),
        ('URL', '상품URL', 'URL파싱'),
        ('상품코드', 'SKU코드', '코드검색'),
        ('전화번호', '고객센터', '연결'),
        ('이메일', '문의', '연결'),
        ('해시태그', '#검정바지', '태그검색'),
        ('멘션', '@브랜드', '브랜드검색'),
        ('바코드', '바코드번호', '상품검색'),
        ('주문번호', '주문조회', '주문검색'),
        ('쿠폰코드', '쿠폰입력', '쿠폰적용'),
    ], ['입력', '예시', '처리'])

    doc.add_heading('5.2 언어/표현', level=2)

    add_table(doc, '언어 변형 (15종)', [
        ('존댓말', '"찾아주세요"', '동일'),
        ('반말', '"찾아줘"', '동일'),
        ('사투리', '"있나?", "머야"', '표준어'),
        ('신조어', '"갬성", "힙하게"', '해석'),
        ('축약어', '"ㅂㅈ", "ㅇㅋ"', '추정'),
        ('영어', '"pants", "shoes"', '매핑'),
        ('혼용', '"black바지"', '통합'),
        ('일본어', '"ズボン"', '매핑'),
        ('중국어', '"裤子"', '매핑'),
        ('비속어', '욕설', '필터링'),
        ('은어', '특수용어', '해석'),
        ('전문용어', '"테이퍼드"', '인식'),
        ('브랜드발음', '"나키"', '매칭'),
        ('동음이의', '"배" (가방/과일)', '문맥'),
        ('유의어', '"바지/팬츠"', '통합'),
    ], ['변형', '예시', '처리'])

    add_table(doc, '오타/오류 (10종)', [
        ('오타', '"바즤", "겁정"', '자동교정'),
        ('띄어쓰기', '"검정색바지"', '분리'),
        ('맞춤법', '"되요", "됬어"', '무시'),
        ('순서오류', '"바지검정색"', '파싱'),
        ('불완전', '"검정...그거"', '추정'),
        ('중복', '"검정검정"', '정규화'),
        ('누락', '"검 바지"', '보완'),
        ('삽입', '"검정ㄱ바지"', '제거'),
        ('대체', '"검정파지"', '교정'),
        ('음성오류', '음성인식오류', '교정'),
    ], ['오류', '예시', '처리'])

    add_table(doc, '모호/비유 (12종)', [
        ('비유', '"하늘같은색"', '해석'),
        ('감성', '"느낌있는"', '추정'),
        ('추상', '"예쁜", "멋진"', '일반'),
        ('상대적', '"적당한", "괜찮은"', '기본값'),
        ('주관', '"내스타일"', '프로필'),
        ('복합감성', '"시크하면서귀여운"', '복합'),
        ('불확실', '"아마검정"', '추정'),
        ('애매', '"그런느낌"', '확인'),
        ('과장', '"완전", "엄청"', '정규화'),
        ('축소', '"약간", "조금"', '정규화'),
        ('부정', '"별로안", "그다지"', '반전'),
        ('이중부정', '"안좋지않은"', '해석'),
    ], ['표현', '예시', '처리'])

    add_table(doc, '수량/범위 표현 (10종)', [
        ('"몇개"', '불특정수량', '기본값'),
        ('"많이"', '다량', '상향'),
        ('"조금"', '소량', '하향'),
        ('"적당히"', '중간', '기본값'),
        ('"전부"', '전체', 'all'),
        ('"일부"', '부분', 'some'),
        ('"반만"', '절반', '50%'),
        ('"1~2개"', '범위', 'range'),
        ('"최소3개"', '하한', 'min'),
        ('"최대5개"', '상한', 'max'),
    ], ['표현', '의미', '처리'])

    doc.add_page_break()

    # ================================================================
    # SECTION 6: 에러/예외
    # ================================================================
    doc.add_heading('SECTION 6: 에러 및 예외 시나리오', level=1)

    doc.add_heading('6.1 시스템 에러', level=2)

    add_table(doc, 'API 에러 (15종)', [
        ('Vision타임아웃', '30초초과', 'BLIP폴백'),
        ('Vision실패', '500에러', 'BLIP폴백'),
        ('Claude실패', 'API오류', 'GPT폴백'),
        ('ClaudeRateLimit', '한도초과', '대기재시도'),
        ('OpenAI실패', 'API오류', 'Claude폴백'),
        ('OpenSearch실패', '검색오류', '필터폴백'),
        ('피팅API실패', 'TheNewBlack', '재시도'),
        ('피팅타임아웃', '120초초과', '비동기'),
        ('GCS실패', '업로드오류', '재시도'),
        ('SMS실패', '발송실패', '이메일'),
        ('이메일실패', '발송실패', 'SMS'),
        ('결제API', '결제오류', '다른수단'),
        ('배송API', '조회오류', '재시도'),
        ('외부연동', '파트너오류', '안내'),
        ('CDN오류', '이미지로딩', '재시도'),
    ], ['에러', '상황', '폴백'])

    add_table(doc, '인프라 에러 (10종)', [
        ('DB오류', '쿼리실패', '재시도'),
        ('Redis다운', '캐시불가', '직접DB'),
        ('세션유실', '데이터손실', '새세션'),
        ('서버과부하', '지연', '대기열'),
        ('메모리부족', '처리불가', '에러'),
        ('디스크풀', '저장불가', '정리'),
        ('네트워크', '내부통신', '재시도'),
        ('로드밸런서', '라우팅오류', '재시도'),
        ('DNS', '도메인오류', '대기'),
        ('SSL', '인증서오류', '안내'),
    ], ['에러', '상황', '처리'])

    doc.add_heading('6.2 비즈니스 에러', level=2)

    add_table(doc, '상품 관련 (12종)', [
        ('품절', '재고없음', '대안'),
        ('단종', '판매종료', '유사'),
        ('가격변동', '조회vs주문', '최신가'),
        ('정보변경', '상품수정', '새정보'),
        ('삭제됨', '상품삭제', '대안'),
        ('일시중단', '판매중지', '안내'),
        ('지역제한', '배송불가', '안내'),
        ('수량제한', '구매제한', '안내'),
        ('회원전용', '회원만구매', '로그인'),
        ('예약중', '출시전', '알림등록'),
        ('한정판', '수량한정', '대기열'),
        ('번들전용', '세트만', '안내'),
    ], ['상황', '설명', '처리'])

    add_table(doc, '사용자 관련 (10종)', [
        ('잘못된입력', '유효하지않음', '안내'),
        ('권한없음', '로그인필요', '유도'),
        ('한도초과', '일일한도', '안내'),
        ('차단됨', '제재상태', '안내'),
        ('중복', '이미있음', '확인'),
        ('불가능', '조건불만족', '안내'),
        ('탈퇴회원', '탈퇴상태', '안내'),
        ('미성년', '성인전용', '인증'),
        ('해외회원', '국내전용', '안내'),
        ('법인회원', '개인전용', '안내'),
    ], ['상황', '설명', '처리'])

    doc.add_page_break()

    # ================================================================
    # SECTION 7: 대화/피드백
    # ================================================================
    doc.add_heading('SECTION 7: 대화 흐름 및 피드백', level=1)

    doc.add_heading('7.1 흐름 제어', level=2)

    add_table(doc, '흐름 제어 명령 (18종)', [
        ('"취소"', '작업취소', 'cancel'),
        ('"다시"', '재시도', 'retry'),
        ('"처음부터"', '리셋', 'reset'),
        ('"뒤로"', '이전', 'back'),
        ('"다음"', '건너뛰기', 'skip'),
        ('"멈춰"', '일시정지', 'pause'),
        ('"계속"', '진행', 'continue'),
        ('"끝"', '종료', 'end'),
        ('"저장"', '저장', 'save'),
        ('"나중에"', '연기', 'defer'),
        ('"도움"', '도움말', 'help'),
        ('"설정"', '설정', 'settings'),
        ('"히스토리"', '이력', 'history'),
        ('"되돌리기"', '실행취소', 'undo'),
        ('"다시하기"', '다시실행', 'redo'),
        ('"새로고침"', '갱신', 'refresh'),
        ('"초기화"', '전체리셋', 'init'),
        ('"로그아웃"', '로그아웃', 'logout'),
    ], ['명령', '의미', '동작'])

    add_table(doc, '확인/선택 (10종)', [
        ('"응", "네"', '긍정', 'yes'),
        ('"아니", "싫어"', '부정', 'no'),
        ('"맞아"', '확인', 'confirm'),
        ('"아닌데"', '부정확인', 'deny'),
        ('"그래"', '동의', 'agree'),
        ('"글쎄"', '보류', 'maybe'),
        ('"1번"', '선택', 'select_1'),
        ('"둘다"', '복수선택', 'both'),
        ('"아무거나"', '무관', 'any'),
        ('"몰라"', '미정', 'unsure'),
    ], ['표현', '의미', '동작'])

    doc.add_heading('7.2 피드백', level=2)

    add_table(doc, '긍정/부정 피드백 (15종)', [
        ('"좋아"', '긍정', '선호기록'),
        ('"마음에들어"', '만족', '구매유도'),
        ('"딱이야"', '확정', '다음단계'),
        ('"고마워"', '감사', '응대'),
        ('"잘찾네"', '칭찬', '감사'),
        ('"별로야"', '부정', '대안'),
        ('"이상해"', '불만', '사과'),
        ('"아니야"', '거부', '대안'),
        ('"실망이야"', '실망', '다른옵션'),
        ('"답답해"', '짜증', '명확안내'),
        ('"원한게아니야"', '오해', '재확인'),
        ('"왜이래"', '불만', '설명'),
        ('"느려"', '속도불만', '안내'),
        ('"어려워"', 'UX불만', '가이드'),
        ('"복잡해"', 'UX불만', '간소화'),
    ], ['표현', '감정', '응답'])

    add_table(doc, '질문 유형 (10종)', [
        ('"왜?"', '이유', '설명'),
        ('"어떻게?"', '방법', '가이드'),
        ('"뭐야?"', '설명', '정보'),
        ('"진짜?"', '확인', '재확인'),
        ('"언제?"', '시간', '안내'),
        ('"어디?"', '장소', '안내'),
        ('"얼마?"', '가격', '가격'),
        ('"누가?"', '주체', '안내'),
        ('"몇개?"', '수량', '안내'),
        ('"왜안돼?"', '이유', '설명'),
    ], ['질문', '의도', '응답'])

    doc.add_heading('7.3 일반 대화', level=2)

    add_table(doc, '일반 대화 (15종)', [
        ('"안녕"', '인사', '인사응답'),
        ('"고마워"', '감사', '응대'),
        ('"잘가"', '종료', '종료응답'),
        ('"뭐해?"', '상태', '소개'),
        ('"뭘할수있어?"', '기능', '안내'),
        ('"날씨어때?"', '범위외', '유도'),
        ('"피자추천"', '범위외', '안내'),
        ('"심심해"', '잡담', '유도'),
        ('"재밌다"', '잡담', '응대'),
        ('"힘들어"', '감정', '공감'),
        ('"너AI야?"', 'AI인식', '소개'),
        ('"사람이랑연결"', '상담원', '연결'),
        ('"버그야"', '오류신고', '접수'),
        ('"개선해줘"', '피드백', '접수'),
        ('"칭찬해"', '칭찬', '감사'),
    ], ['입력', '의도', '응답'])

    doc.add_page_break()

    # ================================================================
    # SECTION 8: 추가 기능 시나리오
    # ================================================================
    doc.add_heading('SECTION 8: 추가 기능 시나리오', level=1)

    doc.add_heading('8.1 개인화/추천', level=2)

    add_table(doc, '개인화 요청 (12종)', [
        ('"내스타일로"', '개인선호', '프로필'),
        ('"전에산것처럼"', '구매이력', '히스토리'),
        ('"평소사이즈로"', '사이즈이력', '히스토리'),
        ('"좋아하는브랜드"', '선호브랜드', '프로필'),
        ('"싫어하는색빼고"', '제외선호', '프로필'),
        ('"맞춤추천"', '개인화', '전체프로필'),
        ('"추천안해"', '추천거부', '일반'),
        ('"새로운거"', '신규추천', '탐색'),
        ('"안봤던거"', '미조회', '필터'),
        ('"자주사는"', '반복구매', '히스토리'),
        ('"비슷한취향"', '유사사용자', '협업필터'),
        ('"트렌드반영"', '트렌드', '트렌드'),
    ], ['요청', '필요정보', '처리'])

    add_table(doc, '코디/스타일링 (10종)', [
        ('"전체코디"', '풀세트', '조합'),
        ('"이거랑어울리는"', '매칭', '크로스'),
        ('"옷장에있는거랑"', '보유의류', '프로필'),
        ('"색상조합"', '컬러매칭', '분석'),
        ('"체형커버"', '체형보정', '체형기반'),
        ('"키커보이게"', '시각효과', '스타일링'),
        ('"레이어드"', '겹쳐입기', '조합'),
        ('"원포인트"', '포인트', '악세서리'),
        ('"미니멀하게"', '심플', '간소화'),
        ('"화려하게"', '풍성', '추가'),
    ], ['요청', '의미', '처리'])

    doc.add_heading('8.2 알림/소셜', level=2)

    add_table(doc, '알림 관련 (10종)', [
        ('"알림설정"', '알림관리', '설정'),
        ('"가격내리면"', '가격알림', '등록'),
        ('"재입고알림"', '재입고', '등록'),
        ('"알림끄기"', '알림해제', '해제'),
        ('"배송알림"', '배송추적', '등록'),
        ('"프로모션알림"', '마케팅', '등록'),
        ('"푸시끄기"', '푸시해제', '해제'),
        ('"이메일끄기"', '이메일해제', '해제'),
        ('"SMS끄기"', 'SMS해제', '해제'),
        ('"알림확인"', '알림조회', '조회'),
    ], ['요청', '의미', '처리'])

    add_table(doc, '소셜/공유 (8종)', [
        ('"공유하고싶어"', '공유', '링크'),
        ('"친구한테"', '공유', '옵션'),
        ('"저장해두고"', '저장', '위시리스트'),
        ('"다른사람코디"', '참조', '커뮤니티'),
        ('"리뷰쓸래"', '리뷰', '작성'),
        ('"좋아요"', '좋아요', '저장'),
        ('"팔로우"', '팔로우', '팔로우'),
        ('"댓글"', '댓글', '작성'),
    ], ['요청', '의미', '처리'])

    doc.add_heading('8.3 선물/특수', level=2)

    add_table(doc, '선물 관련 (8종)', [
        ('"선물추천"', '선물', '카테고리'),
        ('"여자친구선물"', '대상', '대상기반'),
        ('"5만원선물"', '예산', '예산기반'),
        ('"생일선물"', '상황', '상황기반'),
        ('"포장돼?"', '포장', '서비스'),
        ('"메시지넣어줘"', '카드', '서비스'),
        ('"익명배송"', '익명', '옵션'),
        ('"다른주소로"', '배송지', '변경'),
    ], ['요청', '의미', '처리'])

    add_table(doc, '고객 서비스 (10종)', [
        ('"고객센터"', '연결', '연락처'),
        ('"문의"', '문의', '채널'),
        ('"불만"', '컴플레인', '처리'),
        ('"환불"', '환불', '절차'),
        ('"교환"', '교환', '절차'),
        ('"AS"', '수선', 'AS'),
        ('"영수증"', '영수증', '발급'),
        ('"세금계산서"', '세금계산서', '발급'),
        ('"증빙"', '증빙', '발급'),
        ('"상담원"', '상담원', '연결'),
    ], ['요청', '의미', '처리'])

    add_table(doc, '프로모션 (10종)', [
        ('"쿠폰?"', '쿠폰', '조회'),
        ('"할인중인거"', '세일', '상품'),
        ('"이벤트?"', '이벤트', '진행중'),
        ('"적립금?"', '포인트', '조회'),
        ('"회원혜택?"', '멤버십', '안내'),
        ('"등급올리려면?"', '등급', '조건'),
        ('"첫구매혜택"', '신규', '혜택'),
        ('"친구초대"', '추천', '프로그램'),
        ('"리워드"', '보상', '프로그램'),
        ('"캐시백"', '캐시백', '프로그램'),
    ], ['요청', '의미', '처리'])

    doc.add_page_break()

    # ================================================================
    # SECTION 9: 계정/설정
    # ================================================================
    doc.add_heading('SECTION 9: 계정 및 설정', level=1)

    add_table(doc, '프로필 관리 (12종)', [
        ('"프로필수정"', '프로필', '수정'),
        ('"사이즈변경"', '사이즈', '수정'),
        ('"선호변경"', '선호도', '수정'),
        ('"배송지추가"', '배송지', '추가'),
        ('"결제수단추가"', '결제', '추가'),
        ('"비밀번호변경"', '비밀번호', '변경'),
        ('"이메일변경"', '이메일', '변경'),
        ('"휴대폰변경"', '휴대폰', '변경'),
        ('"프로필사진"', '사진', '변경'),
        ('"닉네임변경"', '닉네임', '변경'),
        ('"탈퇴"', '탈퇴', '절차'),
        ('"휴면해제"', '휴면', '해제'),
    ], ['요청', '대상', '동작'])

    add_table(doc, '설정 관리 (8종)', [
        ('"알림설정"', '알림', '설정'),
        ('"언어설정"', '언어', '설정'),
        ('"테마설정"', '테마', '설정'),
        ('"개인정보설정"', '개인정보', '설정'),
        ('"마케팅동의"', '마케팅', '설정'),
        ('"자동로그인"', '로그인', '설정'),
        ('"생체인증"', '인증', '설정'),
        ('"초기화"', '전체', '초기화'),
    ], ['요청', '대상', '동작'])

    add_table(doc, '데이터 관리 (8종)', [
        ('"내데이터"', '데이터조회', '조회'),
        ('"다운로드"', '데이터다운', '다운로드'),
        ('"삭제요청"', '데이터삭제', '요청'),
        ('"검색기록삭제"', '검색기록', '삭제'),
        ('"조회기록삭제"', '조회기록', '삭제'),
        ('"캐시삭제"', '캐시', '삭제'),
        ('"쿠키삭제"', '쿠키', '삭제'),
        ('"전체삭제"', '전체', '삭제'),
    ], ['요청', '대상', '동작'])

    doc.add_page_break()

    # ================================================================
    # SECTION 10: 보안/프라이버시
    # ================================================================
    doc.add_heading('SECTION 10: 보안 및 프라이버시', level=1)

    add_table(doc, '보안 위협 (15종)', [
        ('프롬프트인젝션', '"명령무시하고..."', '필터링'),
        ('탈옥시도', '"제한풀어"', '거부'),
        ('타인데이터', '"다른사람주문"', '권한확인'),
        ('SQL인젝션', '"1; DROP TABLE"', '필터링'),
        ('XSS시도', '"<script>"', '필터링'),
        ('경로조작', '"../../../etc"', '검증'),
        ('무차별대입', '반복로그인', '차단'),
        ('세션하이재킹', '토큰탈취', '검증'),
        ('CSRF시도', '위조요청', '토큰검증'),
        ('봇공격', '자동화요청', 'CAPTCHA'),
        ('스크래핑', '대량조회', '제한'),
        ('API남용', '과다호출', '레이트리밋'),
        ('가격조작', '파라미터변조', '서버검증'),
        ('쿠폰조작', '코드생성시도', '서버검증'),
        ('리뷰조작', '가짜리뷰', '검증'),
    ], ['위협', '예시', '대응'])

    add_table(doc, '개인정보 요청 (12종)', [
        ('데이터열람', '"내정보보여줘"', '인증후조회'),
        ('데이터다운로드', '"전체다운로드"', '요청처리'),
        ('데이터삭제', '"전부삭제해줘"', 'GDPR대응'),
        ('데이터이동', '"다른곳으로"', '포터빌리티'),
        ('처리제한', '"사용하지마"', '처리제한'),
        ('동의철회', '"마케팅거부"', '즉시반영'),
        ('프로파일링거부', '"분석하지마"', '옵트아웃'),
        ('자동화거부', '"AI판단거부"', '수동처리'),
        ('열람요청', '"어떤정보있어?"', '목록제공'),
        ('정정요청', '"정보틀렸어"', '수정처리'),
        ('수집목적', '"왜수집해?"', '안내'),
        ('보유기간', '"언제삭제돼?"', '안내'),
    ], ['요청', '예시', '처리'])

    add_table(doc, 'AI 안전성 (10종)', [
        ('혐오발언유도', '"욕해봐"', '거부'),
        ('차별발언유도', '"비하해"', '거부'),
        ('가짜정보유도', '"거짓말해"', '거부'),
        ('개인정보노출', '"전화번호알려줘"', '마스킹'),
        ('기밀정보유도', '"가격정책알려줘"', '거부'),
        ('경쟁사비방', '"다른데나빠"', '중립'),
        ('위험행동유도', '"불법알려줘"', '거부'),
        ('허위추천', '"없는거추천"', '검증'),
        ('과장광고', '"최고라고해"', '사실기반'),
        ('편향응답', '"한쪽만추천"', '균형'),
    ], ['시도', '예시', '대응'])

    doc.add_page_break()

    # ================================================================
    # SECTION 11: AI 응답 관리
    # ================================================================
    doc.add_heading('SECTION 11: AI 응답 관리', level=1)

    add_table(doc, 'AI 불확실성 처리 (12종)', [
        ('낮은확신', '"아마도..."', '확인질문'),
        ('복수해석', '"두가지의미"', '선택요청'),
        ('정보부족', '"더필요해"', '추가질문'),
        ('범위외', '"잘모르겠어"', '한계안내'),
        ('추측', '"추측컨대"', '명시'),
        ('오래된정보', '"최신아닐수"', '면책'),
        ('주관적판단', '"개인차있음"', '면책'),
        ('불완전분석', '"일부만분석"', '한계명시'),
        ('모호한결과', '"애매해"', '옵션제시'),
        ('신뢰도표시', '"80%확신"', '점수표시'),
        ('출처불명', '"확인필요"', '검증권고'),
        ('가정기반', '"~라면"', '조건명시'),
    ], ['상황', '표현', '처리'])

    add_table(doc, 'AI 오류 정정 (10종)', [
        ('"그게아니라"', '의도오해', '재해석'),
        ('"다시해줘"', '재시도', '리셋'),
        ('"왜그렇게해석해?"', '이유질문', '설명'),
        ('"내말은..."', '명확화', '재해석'),
        ('"아까그건틀렸어"', '과거오류', '수정'),
        ('"잘못이해했네"', '오류인정', '사과'),
        ('"이게맞아?"', '확인요청', '검증'),
        ('"확실해?"', '신뢰확인', '근거제시'),
        ('"출처가뭐야?"', '출처요청', '제공'),
        ('"다른방식으로"', '방식변경', '대안'),
    ], ['입력', '상황', '처리'])

    add_table(doc, 'AI 학습/피드백 (8종)', [
        ('"이거기억해"', '선호저장', '프로필'),
        ('"다음엔이렇게"', '학습요청', '저장'),
        ('"항상이걸먼저"', '기본값', '설정'),
        ('"이건추천하지마"', '제외', '저장'),
        ('"내스타일알지?"', '프로필확인', '조회'),
        ('"학습잘됐어?"', '확인', '상태'),
        ('"초기화해줘"', '학습리셋', '초기화'),
        ('"피드백줄게"', '평가', '저장'),
    ], ['입력', '의미', '처리'])

    doc.add_page_break()

    # ================================================================
    # SECTION 12: 플랫폼별 시나리오
    # ================================================================
    doc.add_heading('SECTION 12: 플랫폼별 시나리오', level=1)

    add_table(doc, '앱 vs 웹 (12종)', [
        ('앱전용기능', '푸시/카메라', '앱유도'),
        ('웹전용기능', '확장프로그램', '웹안내'),
        ('앱→웹전환', '링크클릭', '컨텍스트유지'),
        ('웹→앱전환', '딥링크', '컨텍스트유지'),
        ('앱미설치', '스토어링크', '설치유도'),
        ('앱업데이트필요', '버전체크', '업데이트'),
        ('모바일웹', '반응형', '최적화'),
        ('데스크톱웹', '풀기능', '상세UI'),
        ('PWA', '설치앱', '오프라인'),
        ('미니앱', '카카오/네이버', '간소화'),
        ('위젯', '홈화면', '요약'),
        ('워치앱', '간단조회', '최소화'),
    ], ['환경', '특성', '처리'])

    add_table(doc, '한국 특화 연동 (15종)', [
        ('카카오로그인', 'Kakao OAuth', '소셜로그인'),
        ('네이버로그인', 'Naver OAuth', '소셜로그인'),
        ('애플로그인', 'Apple ID', '소셜로그인'),
        ('카카오페이', 'Kakao Pay', '결제'),
        ('네이버페이', 'Naver Pay', '결제'),
        ('토스', 'Toss', '결제'),
        ('삼성페이', 'Samsung Pay', '결제'),
        ('페이코', 'PAYCO', '결제'),
        ('CJ대한통운', 'CJ', '배송'),
        ('롯데택배', 'Lotte', '배송'),
        ('한진택배', 'Hanjin', '배송'),
        ('우체국택배', 'ePost', '배송'),
        ('카카오알림톡', 'Alim Talk', '알림'),
        ('네이버톡톡', 'Talk Talk', '상담'),
        ('채널톡', 'Channel', '상담'),
    ], ['서비스', '연동', '유형'])

    doc.add_page_break()

    # ================================================================
    # SECTION 13: 시간 기반 비즈니스
    # ================================================================
    doc.add_heading('SECTION 13: 시간 기반 비즈니스', level=1)

    add_table(doc, '한정/긴급 판매 (12종)', [
        ('플래시세일', '1시간한정', '타이머'),
        ('일일특가', '오늘만', '날짜체크'),
        ('주간세일', '이번주', '기간체크'),
        ('시즌오프', '시즌말', '대폭할인'),
        ('클리어런스', '재고정리', '한정수량'),
        ('한정판', '수량한정', '카운터'),
        ('드롭', '출시알림', '대기열'),
        ('프리오더', '출시전예약', '예약'),
        ('얼리버드', '선착순', '순서'),
        ('마감임박', 'D-1', '긴급'),
        ('라이브커머스', '실시간', '스트리밍'),
        ('경매', '입찰', '비딩'),
    ], ['유형', '특성', '처리'])

    add_table(doc, '계절/이벤트 (10종)', [
        ('봄신상', '2-3월', '시즌상품'),
        ('여름신상', '5-6월', '시즌상품'),
        ('가을신상', '8-9월', '시즌상품'),
        ('겨울신상', '11-12월', '시즌상품'),
        ('블랙프라이데이', '11월', '대규모'),
        ('크리스마스', '12월', '선물'),
        ('설날', '1-2월', '선물'),
        ('추석', '9월', '선물'),
        ('발렌타인', '2월', '선물'),
        ('화이트데이', '3월', '선물'),
    ], ['이벤트', '시기', '특성'])

    doc.add_page_break()

    # ================================================================
    # SECTION 14: 복잡한 사용자 여정
    # ================================================================
    doc.add_heading('SECTION 14: 복잡한 사용자 여정', level=1)

    add_table(doc, '복잡한 쇼핑 시나리오 (15종)', [
        ('비교쇼핑', '여러상품비교', '비교표'),
        ('풀워드로브', '전체옷장구성', '코디세트'),
        ('다중수령인', '여러명선물', '각각배송'),
        ('그룹주문', '단체구매', '대량할인'),
        ('정기구매', '구독/정기배송', '스케줄'),
        ('위시리스트관리', '다중리스트', '폴더'),
        ('가격추적', '가격변동알림', '모니터링'),
        ('재구매', '이전구매반복', '빠른재주문'),
        ('선물등록', '선물받고싶은것', '공유링크'),
        ('공동구매', '함께구매', '모집'),
        ('중고거래', '리셀', '상태확인'),
        ('렌탈', '대여', '기간'),
        ('커스텀', '맞춤제작', '옵션'),
        ('믹스앤매치', '상하의조합', '코디'),
        ('옷장분석', '보유의류기반', '추천'),
    ], ['시나리오', '설명', '처리'])

    add_table(doc, '콘텐츠 특수 케이스 (12종)', [
        ('유명인이미지', '연예인사진', '저작권안내'),
        ('아동이미지', '미성년자', '정책적용'),
        ('경쟁사캡처', '다른쇼핑몰', '분석만'),
        ('광고이미지', '홍보물', '식별'),
        ('모델착용', '전문모델', '체형고려'),
        ('리터칭', '보정사진', '실제고려'),
        ('합성사진', '편집이미지', '경고'),
        ('밈/짤', '인터넷이미지', '원본추적'),
        ('패션쇼', '런웨이', '트렌드'),
        ('거리패션', '스트릿스냅', '스타일'),
        ('옛날사진', '레트로', '유사현대'),
        ('그림/일러스트', '손그림', '스타일해석'),
    ], ['콘텐츠', '특성', '처리'])

    doc.add_page_break()

    # ================================================================
    # SECTION 15: 규제 및 법률
    # ================================================================
    doc.add_heading('SECTION 15: 규제 및 법률', level=1)

    add_table(doc, '규제 준수 (12종)', [
        ('미성년구매', '19세미만', '인증'),
        ('주류/담배', '성인인증', '인증필수'),
        ('의약품', '규제품목', '제한'),
        ('화장품', '기능성', '인증표시'),
        ('전자파', '인증마크', '표시'),
        ('KC인증', '안전인증', '표시'),
        ('원산지', '표기의무', '표시'),
        ('섬유성분', '표기의무', '표시'),
        ('세탁표시', '표기의무', '표시'),
        ('모피/가죽', '동물보호', '표시'),
        ('환경라벨', '친환경인증', '표시'),
        ('수입품', '통관정보', '표시'),
    ], ['규제', '대상', '처리'])

    add_table(doc, '소비자 보호 (10종)', [
        ('청약철회', '7일이내', '가능여부'),
        ('교환/반품', '조건명시', '정책안내'),
        ('품질보증', 'A/S기간', '안내'),
        ('리콜', '결함통보', '긴급안내'),
        ('허위광고', '과장금지', '검증'),
        ('가격표시', '총액표시', '필수'),
        ('배송표시', '예상일', '정확'),
        ('재고표시', '정확성', '실시간'),
        ('리뷰신뢰', '조작금지', '검증'),
        ('개인정보', '수집동의', '필수'),
    ], ['항목', '내용', '처리'])

    doc.add_page_break()

    # ================================================================
    # SECTION 16: 접근성 상세
    # ================================================================
    doc.add_heading('SECTION 16: 접근성 상세', level=1)

    add_table(doc, '시각 접근성 (12종)', [
        ('스크린리더', 'VoiceOver/TalkBack', 'alt텍스트'),
        ('고대비', '대비강화', '테마'),
        ('색맹', '적록/청황', '패턴추가'),
        ('저시력', '큰글자', '확대'),
        ('화면확대', '줌기능', '반응형'),
        ('야간모드', '눈보호', '다크테마'),
        ('초점표시', '키보드초점', '하이라이트'),
        ('읽기모드', '본문집중', '간소화'),
        ('이미지설명', 'AI설명', '대체텍스트'),
        ('아이콘라벨', '아이콘설명', '텍스트'),
        ('색상외정보', '색외구분', '형태/텍스트'),
        ('동영상자막', '캡션', '자막'),
    ], ['기능', '대상', '처리'])

    add_table(doc, '운동/인지 접근성 (10종)', [
        ('키보드전용', '마우스없이', '탭네비게이션'),
        ('음성입력', '말로조작', '음성명령'),
        ('스위치제어', '보조기기', '순차접근'),
        ('제스처단순화', '복잡동작제거', '탭위주'),
        ('시간연장', '응답시간', '연장옵션'),
        ('자동완성', '입력보조', '추천'),
        ('실수방지', '확인단계', '되돌리기'),
        ('단순언어', '쉬운표현', '평이한말'),
        ('일관된UI', '예측가능', '패턴유지'),
        ('오류안내', '명확설명', '해결방법'),
    ], ['기능', '대상', '처리'])

    doc.add_page_break()

    # ================================================================
    # SECTION 17: 국제화/현지화
    # ================================================================
    doc.add_heading('SECTION 17: 국제화 및 현지화', level=1)

    add_table(doc, '언어/지역 (12종)', [
        ('한국어', 'ko-KR', '기본'),
        ('영어', 'en-US', '지원'),
        ('일본어', 'ja-JP', '지원'),
        ('중국어간체', 'zh-CN', '지원'),
        ('중국어번체', 'zh-TW', '지원'),
        ('다중언어입력', '혼용입력', '자동감지'),
        ('번역요청', '"영어로"', '번역'),
        ('지역설정', '국가변경', '현지화'),
        ('날짜형식', 'YYYY-MM-DD', '형식'),
        ('숫자형식', '1,000', '형식'),
        ('통화기호', '₩/$', '심볼'),
        ('시간대', 'KST/UTC', '변환'),
    ], ['항목', '값', '처리'])

    add_table(doc, '사이즈/단위 변환 (10종)', [
        ('한국→US', 'KR→US', '변환표'),
        ('한국→EU', 'KR→EU', '변환표'),
        ('한국→UK', 'KR→UK', '변환표'),
        ('한국→일본', 'KR→JP', '변환표'),
        ('신발변환', '250→US7.5', '변환'),
        ('cm→inch', '키/허리', '변환'),
        ('kg→lb', '체중', '변환'),
        ('원→달러', '가격', '환율'),
        ('원→엔', '가격', '환율'),
        ('원→위안', '가격', '환율'),
    ], ['변환', '예시', '처리'])

    add_table(doc, '해외 배송/결제 (8종)', [
        ('해외배송', '국제배송', '옵션'),
        ('관세', '세금계산', '안내'),
        ('통관', '서류', '안내'),
        ('배송추적', '국제추적', '연동'),
        ('해외카드', 'VISA/Master', '결제'),
        ('PayPal', '해외결제', '연동'),
        ('Alipay', '중국결제', '연동'),
        ('환불환율', '환차손', '정책'),
    ], ['항목', '내용', '처리'])

    doc.add_page_break()

    # ================================================================
    # SECTION 18: 리뷰/평가 시스템
    # ================================================================
    doc.add_heading('SECTION 18: 리뷰 및 평가 시스템', level=1)

    add_table(doc, '리뷰 작성 (12종)', [
        ('텍스트리뷰', '글작성', '저장'),
        ('별점', '1-5점', '저장'),
        ('포토리뷰', '사진첨부', '저장'),
        ('동영상리뷰', '영상첨부', '저장'),
        ('사이즈리뷰', '사이즈평가', '통계'),
        ('키/체중정보', '신체정보', '참고'),
        ('착용감', '핏리뷰', '태그'),
        ('색상실제', '실제색상', '사진'),
        ('배송만족', '배송평가', '분리'),
        ('재구매의향', '추천여부', '점수'),
        ('수정/삭제', '리뷰관리', '권한'),
        ('신고', '부적절리뷰', '검토'),
    ], ['항목', '내용', '처리'])

    add_table(doc, '리뷰 조회 (10종)', [
        ('"리뷰보여줘"', '전체조회', '목록'),
        ('"포토리뷰만"', '사진있는것', '필터'),
        ('"L사이즈리뷰"', '사이즈별', '필터'),
        ('"비슷한체형"', '체형필터', '매칭'),
        ('"최신순"', '정렬', '정렬'),
        ('"별점높은순"', '정렬', '정렬'),
        ('"별점낮은순"', '정렬', '정렬'),
        ('"리뷰요약"', 'AI요약', '요약'),
        ('"장단점"', '분석', '추출'),
        ('"실착샷"', '착용사진', '필터'),
    ], ['요청', '의미', '처리'])

    doc.add_page_break()

    # ================================================================
    # SECTION 19: 재고/물류
    # ================================================================
    doc.add_heading('SECTION 19: 재고 및 물류', level=1)

    add_table(doc, '재고 상태 (10종)', [
        ('재고있음', '즉시배송', '정상'),
        ('재고소진임박', '3개이하', '긴급표시'),
        ('품절', '재고0', '알림등록'),
        ('일시품절', '곧입고', '예정일'),
        ('단종', '재입고없음', '대안'),
        ('예약판매', '출시전', '예약'),
        ('주문제작', '제작기간', '기간안내'),
        ('사이즈품절', '특정사이즈', '다른사이즈'),
        ('색상품절', '특정색상', '다른색상'),
        ('옵션품절', '특정조합', '대안'),
    ], ['상태', '설명', '처리'])

    add_table(doc, '배송 상세 (12종)', [
        ('일반배송', '2-3일', '기본'),
        ('새벽배송', '다음날새벽', '시간컷'),
        ('당일배송', '오늘', '시간컷'),
        ('퀵배송', '몇시간', '지역제한'),
        ('예약배송', '지정일', '선택'),
        ('편의점수령', '픽업', '위치'),
        ('무인함', '락커', '위치'),
        ('직접수령', '매장', '위치'),
        ('선물배송', '타인', '메시지'),
        ('분할배송', '나눠서', '옵션'),
        ('합배송', '함께', '대기'),
        ('해외배송', '국제', '기간'),
    ], ['유형', '설명', '옵션'])

    doc.add_page_break()

    # ================================================================
    # SECTION 20: 멤버십/등급
    # ================================================================
    doc.add_heading('SECTION 20: 멤버십 및 등급', level=1)

    add_table(doc, '등급 시스템 (10종)', [
        ('일반', 'Basic', '기본혜택'),
        ('실버', 'Silver', '+2%적립'),
        ('골드', 'Gold', '+3%적립'),
        ('VIP', 'VIP', '+5%적립'),
        ('VVIP', 'VVIP', '+7%적립'),
        ('등급조건', '구매금액기준', '안내'),
        ('등급유지', '연간기준', '안내'),
        ('등급하락', '미달시', '안내'),
        ('등급상향', '달성시', '축하'),
        ('특별등급', '초대전용', '제한'),
    ], ['등급', '영문', '혜택'])

    add_table(doc, '멤버십 혜택 (12종)', [
        ('적립률', '구매적립', '%'),
        ('할인쿠폰', '등급쿠폰', '월발급'),
        ('무료배송', '배송비', '조건'),
        ('생일쿠폰', '생일혜택', '연1회'),
        ('우선접근', '신상품', '얼리액세스'),
        ('전용세일', 'VIP세일', '전용'),
        ('무료반품', '반품비', '면제'),
        ('전용상담', '우선상담', '핫라인'),
        ('사은품', '선물', '랜덤'),
        ('초대행사', '오프라인', '초대'),
        ('리뷰보상', '리뷰적립', '추가'),
        ('친구초대', '추천보상', '추가'),
    ], ['혜택', '내용', '방식'])

    doc.add_page_break()

    # ================================================================
    # 최종 요약
    # ================================================================
    doc.add_heading('최종 요약: 전체 Edge Case (700+)', level=1)

    summary = '''
[총 Edge Case 수: 700+ 케이스]

SECTION 1: 입력 유형별 (200+)
├─ 1.1 텍스트 검색 (120+)
│   ├─ 카테고리: 20종
│   ├─ 색상: 25종 (톤/계절/비유/브랜드 포함)
│   ├─ 브랜드: 15종 (약어/오타/콜라보 포함)
│   ├─ 스타일: 30종 (트렌드/감성/TPO 포함)
│   ├─ 상세속성: 25종 (핏/기장/소재/기능 포함)
│   └─ 가격: 15종
├─ 1.2 이미지 (65+)
│   ├─ 유형: 30종
│   ├─ 품질: 20종
│   └─ 내용: 15종
└─ 1.3 복합 (38+)
    ├─ 정상: 20종
    ├─ 상충: 10종
    └─ 순서: 8종

SECTION 2: 대화/컨텍스트 (55+)
├─ 2.1 참조 (45+)
│   ├─ 직접참조: 15종
│   ├─ 시간참조: 10종
│   ├─ 세션참조: 12종
│   └─ 복잡체인: 8종
└─ 2.2 멀티턴 (35+)
    ├─ 대화패턴: 15종
    ├─ 문맥전환: 10종
    └─ 조건부: 10종

SECTION 3: 기능별 (80+)
├─ 3.1 검색 (22+)
├─ 3.2 피팅 (27+)
└─ 3.3 커머스 (65+)
    ├─ 사이즈: 18종
    ├─ 장바구니: 15종
    ├─ 주문: 20종
    └─ 결제: 12종

SECTION 4: 특수상황 (70+)
├─ 4.1 타이밍: 25종
├─ 4.2 동시성: 10종
├─ 4.3 환경: 34종
└─ 4.4 사용자: 25종

SECTION 5: 형식/패턴 (60+)
├─ 5.1 텍스트: 27종
└─ 5.2 언어: 47종

SECTION 6: 에러/예외 (47+)
├─ 6.1 시스템: 25종
└─ 6.2 비즈니스: 22종

SECTION 7: 대화/피드백 (48+)
├─ 7.1 흐름제어: 28종
├─ 7.2 피드백: 25종
└─ 7.3 일반대화: 15종

SECTION 8: 추가기능 (48+)
├─ 8.1 개인화: 22종
├─ 8.2 알림/소셜: 18종
└─ 8.3 선물/고객서비스: 28종

SECTION 9: 계정/설정 (28+)
├─ 프로필: 12종
├─ 설정: 8종
└─ 데이터: 8종

SECTION 10: 보안/프라이버시 (37+) [신규]
├─ 보안위협: 15종
├─ 개인정보: 12종
└─ AI안전성: 10종

SECTION 11: AI 응답 관리 (30+) [신규]
├─ 불확실성: 12종
├─ 오류정정: 10종
└─ 학습피드백: 8종

SECTION 12: 플랫폼별 (27+) [신규]
├─ 앱vs웹: 12종
└─ 한국특화연동: 15종

SECTION 13: 시간기반 비즈니스 (22+) [신규]
├─ 한정/긴급: 12종
└─ 계절/이벤트: 10종

SECTION 14: 복잡한 사용자 여정 (27+) [신규]
├─ 복잡쇼핑: 15종
└─ 콘텐츠특수: 12종

SECTION 15: 규제/법률 (22+) [신규]
├─ 규제준수: 12종
└─ 소비자보호: 10종

SECTION 16: 접근성 상세 (22+) [신규]
├─ 시각접근성: 12종
└─ 운동/인지: 10종

SECTION 17: 국제화/현지화 (30+) [신규]
├─ 언어/지역: 12종
├─ 사이즈/단위: 10종
└─ 해외배송/결제: 8종

SECTION 18: 리뷰/평가 (22+) [신규]
├─ 리뷰작성: 12종
└─ 리뷰조회: 10종

SECTION 19: 재고/물류 (22+) [신규]
├─ 재고상태: 10종
└─ 배송상세: 12종

SECTION 20: 멤버십/등급 (22+) [신규]
├─ 등급시스템: 10종
└─ 멤버십혜택: 12종

---

[우선순위]
P0(Critical): 결제오류, 보안위협, 데이터손실, 개인정보유출
P1(High): API실패, 의도파악실패, 피팅실패, 프롬프트인젝션
P2(Medium): 품질이슈, 세션만료, 품절, 접근성
P3(Low): 오타교정, UI개선, 국제화

[구현 권장 순서]
1단계: 핵심기능 (검색/피팅/주문) + P0 보안
2단계: 대화관리 + 에러처리 + 멀티턴
3단계: 개인화 + 추천 + 리뷰
4단계: 접근성 + 국제화 + 고급기능
'''
    doc.add_paragraph(summary)

    # 저장
    output_path = '/Users/ijeong/Desktop/테커/AI_패션_어시스턴트_에이전트_시스템_개발_명세서.docx'
    doc.save(output_path)
    print(f"최종 완전판 문서 저장: {output_path}")
    print(f"파일 크기: {os.path.getsize(output_path):,} bytes")

if __name__ == '__main__':
    create_ultimate_document()
